<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Registro Cliente - My Car</title>

    <link th:href="@{/vendor/fontawesome-free/css/all.min.css}" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,300,400,700" rel="stylesheet">
    <link th:href="@{/css/sb-admin-2.min.css}" rel="stylesheet">

    <style>
        .card { border-radius: 1rem !important; }
        .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
        }
        .form-section {
            background: #f8f9fc;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
        }
    </style>
</head>

<body class="bg-gradient-primary">

<div class="container">
    <div class="row justify-content-center">
        <div class="col-xl-10 col-lg-12">
            <div class="card o-hidden border-0 shadow-lg my-5">
                <div class="card-body p-5">

                    <div class="text-center mb-4">
                        <div class="rotate-n-15" style="display:inline-block; font-size:3rem; color:#4e73df;">
                            <i class="fas fa-car"></i>
                        </div>
                        <h1 class="h3 text-gray-900 mt-3 mb-2">Registro de Cliente</h1>
                        <p class="text-gray-600">Crea tu cuenta para comenzar</p>
                    </div>

                    <!-- Errores -->
                    <div th:if="${error}" class="alert alert-danger alert-dismissible fade show">
                        <i class="fas fa-exclamation-circle mr-2"></i>
                        <span th:text="${error}"></span>
                        <button type="button" class="close" data-dismiss="alert"><span>&times;</span></button>
                    </div>

                    <form class="user" th:action="@{/auth/registro}" method="post">

                        <!-- Sección 1: Datos Personales -->
                        <div class="section-header">
                            <h6 class="m-0"><i class="fas fa-user mr-2"></i>Datos Personales</h6>
                        </div>

                        <div class="form-section">
                            <div class="form-group row">
                                <div class="col-sm-6 mb-3">
                                    <label class="small font-weight-bold">Nombre <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control form-control-user"
                                           name="nombre" placeholder="Nombre" required>
                                </div>
                                <div class="col-sm-6 mb-3">
                                    <label class="small font-weight-bold">Apellido <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control form-control-user"
                                           name="apellido" placeholder="Apellido" required>
                                </div>
                            </div>

                            <div class="form-group row">
                                <div class="col-sm-6 mb-3">
                                    <label class="small font-weight-bold">Fecha de Nacimiento <span class="text-danger">*</span></label>
                                    <input type="date" class="form-control form-control-user"
                                           name="fechaNacimiento" id="fechaNacimiento" required>
                                    <small class="form-text text-muted">Debe ser mayor de 18 años</small>
                                </div>
                                <div class="col-sm-6 mb-3">
                                    <label class="small font-weight-bold">Email <span class="text-danger">*</span></label>
                                    <input type="email" class="form-control form-control-user"
                                           name="email" placeholder="correo@ejemplo.com" required>
                                </div>
                            </div>

                            <div class="form-group row">
                                <div class="col-sm-4 mb-3">
                                    <label class="small font-weight-bold">Tipo de Documento <span class="text-danger">*</span></label>
                                    <select class="form-control" name="tipoDocumento" required>
                                        <option value="">Seleccione</option>
                                        <option value="DNI">DNI</option>
                                        <option value="CARNET_DE_CONDUCIR">Carnet de Conducir</option>
                                    </select>
                                </div>
                                <div class="col-sm-4 mb-3">
                                    <label class="small font-weight-bold">Número de Documento <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control form-control-user"
                                           name="numeroDocumento" placeholder="12345678" required>
                                </div>
                                <div class="col-sm-4 mb-3">
                                    <label class="small font-weight-bold">Teléfono <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control form-control-user"
                                           name="telefono" placeholder="2615551234" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="small font-weight-bold">Nacionalidad <span class="text-danger">*</span></label>
                                <select class="form-control" name="nacionalidadId" required>
                                    <option value="">Seleccione una nacionalidad</option>
                                    <option th:each="nacionalidad : ${nacionalidades}" 
                                            th:value="${nacionalidad.id}" 
                                            th:text="${nacionalidad.nombre}"></option>
                                </select>
                            </div>
                        </div>

                        <!-- Sección 2: Dirección -->
                        <div class="section-header">
                            <h6 class="m-0"><i class="fas fa-map-marker-alt mr-2"></i>Dirección</h6>
                        </div>

                        <div class="form-section">
                            <div class="form-group row">
                                <div class="col-sm-8 mb-3">
                                    <label class="small font-weight-bold">Calle <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control form-control-user"
                                           name="calle" placeholder="Av. San Martín" required>
                                </div>
                                <div class="col-sm-4 mb-3">
                                    <label class="small font-weight-bold">Número <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control form-control-user"
                                           name="numero" placeholder="1234" required>
                                </div>
                            </div>

                            <div class="form-group row">
                                <div class="col-sm-6 mb-3">
                                    <label class="small font-weight-bold">Barrio</label>
                                    <input type="text" class="form-control form-control-user"
                                           name="barrio" placeholder="Centro">
                                </div>
                                <div class="col-sm-6 mb-3">
                                    <label class="small font-weight-bold">Localidad <span class="text-danger">*</span></label>
                                    <select class="form-control" name="localidadId" required>
                                        <option value="">Seleccione una localidad</option>
                                        <option th:each="localidad : ${localidades}" 
                                                th:value="${localidad.id}" 
                                                th:text="${localidad.nombre + ' (' + localidad.codigoPostal + ')'}"></option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group row">
                                <div class="col-sm-6 mb-3">
                                    <label class="small font-weight-bold">Manzana/Piso</label>
                                    <input type="text" class="form-control form-control-user"
                                           name="manzanaPiso" placeholder="Piso 3">
                                </div>
                                <div class="col-sm-6 mb-3">
                                    <label class="small font-weight-bold">Casa/Departamento</label>
                                    <input type="text" class="form-control form-control-user"
                                           name="casaDepartamento" placeholder="Depto A">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="small font-weight-bold">Referencia</label>
                                <textarea class="form-control" name="referencia" rows="2" 
                                          placeholder="Frente a la plaza principal"></textarea>
                            </div>

                            <div class="form-group">
                                <label class="small font-weight-bold">Dirección de Estadía</label>
                                <textarea class="form-control" name="direccionEstadia" rows="2"
                                          placeholder="Si está de visita, indique dónde se hospeda"></textarea>
                            </div>
                        </div>

                        <!-- Sección 3: Datos de Acceso -->
                        <div class="section-header">
                            <h6 class="m-0"><i class="fas fa-lock mr-2"></i>Datos de Acceso</h6>
                        </div>

                        <div class="form-section">
                            <div class="form-group">
                                <label class="small font-weight-bold">Nombre de Usuario <span class="text-danger">*</span></label>
                                <input type="text" class="form-control form-control-user"
                                       name="nombreUsuario" placeholder="usuario123" required minlength="3">
                                <small class="form-text text-muted">Mínimo 3 caracteres</small>
                            </div>

                            <div class="form-group row">
                                <div class="col-sm-6 mb-3">
                                    <label class="small font-weight-bold">Contraseña <span class="text-danger">*</span></label>
                                    <input type="password" class="form-control form-control-user"
                                           name="clave" id="clave" placeholder="Contraseña" required minlength="6">
                                    <small class="form-text text-muted">Mínimo 6 caracteres</small>
                                </div>
                                <div class="col-sm-6">
                                    <label class="small font-weight-bold">Repetir Contraseña <span class="text-danger">*</span></label>
                                    <input type="password" class="form-control form-control-user"
                                           name="confirmarClave" id="confirmarClave" placeholder="Repetir contraseña" required>
                                </div>
                            </div>
                        </div>

                        <button class="btn btn-primary btn-user btn-block" type="submit">
                            <i class="fas fa-user-plus mr-2"></i> Crear Cuenta
                        </button>
                    </form>

                    <hr>

                    <div class="text-center">
                        <a class="small" th:href="@{/auth/login}">
                            ¿Ya tenés cuenta? Iniciá sesión
                        </a>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<script th:src="@{/vendor/jquery/jquery.min.js}"></script>
<script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/vendor/jquery-easing/jquery.easing.min.js}"></script>
<script th:src="@{/js/sb-admin-2.min.js}"></script>

<script>
    // Establecer fecha máxima para fecha de nacimiento (debe ser mayor de 18 años)
    document.addEventListener('DOMContentLoaded', function() {
        var fechaInput = document.getElementById('fechaNacimiento');
        if (fechaInput) {
            var today = new Date();
            var maxDate = new Date(today.getFullYear() - 18, today.getMonth(), today.getDate());
            fechaInput.setAttribute('max', maxDate.toISOString().split('T')[0]);
        }

        // Validar que las contraseñas coincidan
        var form = document.querySelector('form');
        form.addEventListener('submit', function(e) {
            var clave = document.getElementById('clave').value;
            var confirmarClave = document.getElementById('confirmarClave').value;
            
            if (clave !== confirmarClave) {
                e.preventDefault();
                alert('Las contraseñas no coinciden');
                return false;
            }
        });
    });
</script>

</body>
</html>