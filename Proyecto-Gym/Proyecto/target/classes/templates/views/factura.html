<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <title>Factura</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0; /* elimina el espacio que empuja el navbar */
            color: #333;
        }
        .factura-container {
            max-width: 800px;
            margin: 20px auto; /* centrado y con espacio */
            border: 1px solid #ccc;
            padding: 20px;
        }
        h2, h3 {
            margin-top: 0;
            text-align: center;
        }
        .info {
            margin-bottom: 20px;
        }
        .info p {
            margin: 4px 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .totales {
            margin-top: 20px;
            text-align: right;
        }
    </style>
</head>
<div th:fragment="nav_bar">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">

            <!-- Logo / Marca -->
            <a class="navbar-brand" th:href="@{/}">Gimnasio</a>

            <!-- Botón hamburguesa -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMain">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Contenido -->
            <div class="collapse navbar-collapse" id="navbarsMain">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" th:href="@{/empleados}" th:if="${usuariosession != null and usuariosession.rol == T(com.sport.proyecto.enums.Rol).ADMIN}">Gestionar Empleados</a></li>
                    <li class="nav-item"><a class="nav-link" th:href="@{/socios}" th:if="${usuariosession != null and usuariosession.rol == T(com.sport.proyecto.enums.Rol).ADMIN}">Gestionar Socios</a></li>
                    <!--<li class="nav-item" th:if="${usuariosession != null and usuariosession.rol == T(com.sport.proyecto.enums.Rol).ADMIN}">
                      <a class="nav-link" th:href="@{/admin/panel}">Panel Admin</a>
                    </li>-->
                    <li class="nav-item"><a class="nav-link" th:href="@{/mensaje}" th:if="${usuariosession != null and usuariosession.rol == T(com.sport.proyecto.enums.Rol).ADMIN}">Enviar Mensajes</a></li>
                    <li class="nav-item"><a class="nav-link" th:href="@{/rutina/mis_rutinas}" th:if="${usuariosession != null}">Mis Rutinas</a></li>
                    <li class="nav-item" th:if="${usuariosession != null and usuariosession.rol == T(com.sport.proyecto.enums.Rol).SOCIO}">
                        <a class="nav-link" th:href="@{/cuotas}">Gestion Cuotas</a>
                    </li>
                </ul>

                <!-- Buscador -->
                <form class="d-flex" th:action="@{/buscar}" method="get">
                    <input class="form-control me-2" type="search" name="q" placeholder="Buscar" aria-label="Buscar"/>
                    <button class="btn btn-outline-light" type="submit">Buscar</button>
                </form>

                <!-- Login / Logout -->
                <ul class="navbar-nav ms-3">
                    <li class="nav-item">
                    <span class="navbar-text text-white me-3"
                          th:text="${usuariosession != null ? usuariosession.nombreUsuario : 'Invitado'}"></span>
                    </li>
                    <li class="nav-item" th:if="${usuariosession != null}">
                        <a class="nav-link" th:href="@{/logout}">Logout</a>
                    </li>
                    <li class="nav-item" th:if="${usuariosession == null}">
                        <a class="nav-link" th:href="@{/login}">Login</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>

<body>
<div class="factura-container">
    <h2>Factura</h2>

    <!-- Datos de la factura -->
    <div class="info">
        <h3>Datos de la Factura</h3>
        <p><strong>Número:</strong> <span th:text="${factura.numeroFactura}"></span></p>
        <p><strong>Fecha:</strong> <span th:text="${factura.fechaFactura}"></span></p>
        <p><strong>Estado:</strong> <span th:text="${factura.estadoFactura}"></span></p>
    </div>

    <!-- Datos del cliente -->
    <div class="info">
        <h3>Datos del Cliente</h3>
        <p><strong>Nombre:</strong> <span th:text="${cliente.nombre}"></span></p>
        <p><strong>Apellido:</strong> <span th:text="${cliente.apellido}"></span></p>
        <p><strong>DNI:</strong> <span th:text="${cliente.numeroDocumento}"></span></p>
        <p><strong>Email:</strong> <span th:text="${cliente.email}"></span></p>
    </div>

    <!-- Detalle de cuotas -->
    <div class="info">
        <h3>Detalle de Cuotas</h3>
        <table>
            <tr>
                <th>Mes</th>
                <th>Año</th>
                <th>Valor</th>
                <th>Vencimiento</th>
                <th>Estado</th>
            </tr>
            <tr th:each="detalle : ${detalle}">
                <td th:text="${detalle.cuotaMensual.mes}">Mes</td>
                <td th:text="${detalle.cuotaMensual.anio}">Año</td>
                <td th:text="${detalle.cuotaMensual.valorCuota.valor}">Valor</td>
                <td th:text="${detalle.cuotaMensual.estado}">Estado</td>
            </tr>
        </table>
    </div>

    <!-- Total -->
    <div class="totales">
        <p><strong>Total Pagado:</strong> <span th:text="${factura.totalPagado}"></span></p>
    </div>
</div>
<div class="section" style="text-align:center; margin-top:20px;">
    <button onclick="window.print()">Imprimir</button>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
